setwd("~/git/building-and-safety-complaints/repo/building_and_safety/data")
data <- read.csv("inspection_district_export.csv")
data
?lplot
?plot
plot(data["complaints"], data["median_wait"])
?ggplot
data["complaints"]
plot(data)
plot(data["complaints"])
plot(data["complaints"], data["median_wait"])
data <- data[with(data, order(-complaints))]
data[order("complaints")]
?order
data[order(complaints)]
data[order(data[complaints])]
data[order(data["complaints"])]
sort(data["complaints"])
data["complaints"]
order(data["complaints"])
sort(data["complaints"])
data[order(data$complaints),]
data <- data[order(data$complaints),]
data
plot(data$complaints, data$median_wait)
ggplot(data, aes(x=complaints, y=median_wait)) + geom_point(shape=1) + geom_smooth=(method=lm)
library("ggplot2")
ggplot(data, aes(x=complaints, y=median_wait)) + geom_point(shape=1) + geom_smooth=(method=lm)
ggplot(data, aes(x=complaints, y=median_wait)) + geom_point(shape=1) + geom_smooth(method=lm)
data[-1,]
data <- data[-1,]
ggplot(data, aes(x=complaints, y=median_wait)) + geom_point(shape=1) + geom_smooth(method=lm)
View(data)
districts <- read.csv("inspection_district_export.csv")
districts
districts <- districts[order(districts$complaints),]
districts
districts <- districts[-1,]
districst
districts
p1 <- ggplot(districts, aes(x=complaints, y=median_wait)) + geom_point(shape=1) + geom_smooth(method=lm)
p1
p1 <- ggplot(districts, aes(x=complaints, y=median_wait)) + geom_point(shape=1) + geom_smooth(method=lm) + ggtitle("all complaints")
p2 <- ggplot(districts, aes(x=csr1_complaints, y=median_wait_csr1)) + geom_point(shape=1) + geom_smooth(method=lm) + ggtitle("CSR1 complaints")
p3 <- ggplot(districts, aes(x=csr2_complaints, y=median_wait_csr2)) + geom_point(shape=1) + geom_smooth(method=lm) + ggtitle("CSR2 complaints")
p4 <- ggplot(districts, aes(x=csr3_complaints, y=median_wait_csr3)) + geom_point(shape=1) + geom_smooth(method=lm) + ggtitle("CSR3 complaints")
multiplot(p1, p2, p3, p4, cols=2)
multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {
require(grid)
# Make a list from the ... arguments and plotlist
plots <- c(list(...), plotlist)
numPlots = length(plots)
# If layout is NULL, then use 'cols' to determine layout
if (is.null(layout)) {
# Make the panel
# ncol: Number of columns of plots
# nrow: Number of rows needed, calculated from # of cols
layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
ncol = cols, nrow = ceiling(numPlots/cols))
}
if (numPlots==1) {
print(plots[[1]])
} else {
# Set up the page
grid.newpage()
pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))
# Make each plot, in the correct location
for (i in 1:numPlots) {
# Get the i,j matrix positions of the regions that contain this subplot
matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))
print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
layout.pos.col = matchidx$col))
}
}
}
multiplot(p1, p2, p3, p4, cols=2)
p4
View(districts)
?geom_smooth
ggplot(districts, aes(x=csr3_complaints, y=median_wait_csr3)) + geom_point(shape=1) + geom_smooth(method=lm, na.rm=TRUE) + ggtitle("CSR3 complaints")
ggplot(districts[-12,], aes(x=csr3_complaints, y=median_wait_csr3)) + geom_point(shape=1) + geom_smooth(method=lm, na.rm=TRUE) + ggtitle("CSR3 complaints")
districts[-12,]
ggplot(districts[c(-12,-26),], aes(x=csr3_complaints, y=median_wait_csr3)) + geom_point(shape=1) + geom_smooth(method=lm, na.rm=TRUE) + ggtitle("CSR3 complaints")
p4 <- ggplot(districts[c(-12,-26),], aes(x=csr3_complaints, y=median_wait_csr3)) + geom_point(shape=1) + geom_smooth(method=lm, na.rm=TRUE) + ggtitle("CSR3 complaints")
multiplot(p1, p2, p3, p4, cols=2)
p1.lm
?ggplot
?geom_smooth
p1.data
p1$data
p1$layers
p1$mapping
dir(p1)
?p1
resid(p1)
m1 <- lm(districts$complaints~districts$median_wait)
m1
resid(m1)
plot(density(resid(m1)))
qqnorm(resid(m1))
qqline(resid(m1))
m1 <- lm(districts$csr1_complaints~districts$median_wait_csr1)
m1 <- lm(districts$complaints~districts$median_wait)
m2 <- lm(districts$csr1_complaints~districts$median_wait_csr1)
m3 <- lm(districts$csr2_complaints~districts$median_wait_csr2)
m4 <- lm(districts$csr3_complaints~districts$median_wait_csr3)
m4 <- lm(districts[c(-12,-26)]$csr3_complaints~districts[c(-12,-26)]$median_wait_csr3)
m4 <- lm(districts[c(-12,-26),]$csr3_complaints~districts[c(-12,-26),]$median_wait_csr3)
m4
m1
m2
m3
m4
p4 <- ggplot(districts[c(-12,-26),], aes(x=csr3_complaints, y=median_wait_csr3)) + geom_point(shape=1) + geom_smooth(method=lm, na.rm=TRUE) + ggtitle("CSR3 complaints") + geom_text()
p4
p4 <- ggplot(districts[c(-12,-26),], aes(x=csr3_complaints, y=median_wait_csr3, label=rownames(district_number))) + geom_point(shape=1) + geom_smooth(method=lm, na.rm=TRUE) + ggtitle("CSR3 complaints") + geom_text()
p4
p4 <- ggplot(districts[c(-12,-26),], aes(x=csr3_complaints, y=median_wait_csr3)) + geom_point(shape=1) + geom_smooth(method=lm, na.rm=TRUE) + ggtitle("CSR3 complaints") + geom_text(label=rownames(district_number))
p4 <- ggplot(districts[c(-12,-26),], aes(x=csr3_complaints, y=median_wait_csr3)) + geom_point(shape=1) + geom_smooth(method=lm, na.rm=TRUE) + ggtitle("CSR3 complaints") + geom_text(label=rownames(districts$district_number))
p4
p4 <- ggplot(districts[c(-12,-26),], aes(x=csr3_complaints, y=median_wait_csr3, label=rownames(district_number))) + geom_point(shape=1) + geom_smooth(method=lm, na.rm=TRUE) + ggtitle("CSR3 complaints") + geom_text(label=rownames(districts$district_number))
p4
p4 <- ggplot(districts[c(-12,-26),], aes(x=csr3_complaints, y=median_wait_csr3, label=rownames(district_number))) + geom_point(shape=1) + geom_smooth(method=lm, na.rm=TRUE) + ggtitle("CSR3 complaints") + geom_text()
p4
p4 <- ggplot(districts[c(-12,-26),], aes(x=csr3_complaints, y=median_wait_csr3)) + geom_point(shape=1) + geom_smooth(method=lm, na.rm=TRUE) + ggtitle("CSR3 complaints") + geom_text(label=rownames(districts$district_number))
p4
summary(m1)
summary(p1)
summary(m1)
summary(m2)
summary(m3)
summary(m4)
p1 + geom_text()
p1 + geom_text(label=districts$district_name)
p1 + geom_text(label=districts[-1,]$district_name)
View(districts)
p1 + geom_text(label=districts$district_number)
p1 + geom_text(label=district_number)
p1 + geom_text(label=districts$district_number)
p1 + geom_text(label=districts$district_number,x=10)
p1 + geom_text(label=districts$district_number)
?geom_text
p1 + geom_text(label=districts$district_number, hjust=10)
p1 + geom_text(label=districts$district_number, hjust=0.5)
p1 + geom_text(label=districts$district_number, hjust=1)
p1 + geom_text(label=districts$district_number, hjust=1.1)
p1 + geom_text(label=districts$district_number, hjust=1.2)
p1 <- p1 + geom_text(label=districts$district_number, hjust=1.2)
p2 <- p2 + geom_text(label=districts$district_number, hjust=1.2)
p3 <- p3 + geom_text(label=districts$district_number, hjust=1.2)
p4 <- ggplot(districts[c(-12,-26),], aes(x=csr3_complaints, y=median_wait_csr3)) + geom_point(shape=1) + geom_smooth(method=lm, na.rm=TRUE) + ggtitle("CSR3 complaints")
p4
p4 <- p4 + geom_text(label=districts$district_number, hjust=1.2)
multiplot(p1, p2, p3, p4, cols=2)
p4 <- p4 + geom_text(label=districts[c(-12,-26),]$district_number, hjust=1.2)
multiplot(p1, p2, p3, p4, cols=2)
p4
p4 <- ggplot(districts[c(-12,-26),], aes(x=csr3_complaints, y=median_wait_csr3)) + geom_point(shape=1) + geom_smooth(method=lm, na.rm=TRUE) + ggtitle("CSR3 complaints")
p4 <- ggplot(districts[c(-12,-26),], aes(x=csr3_complaints, y=median_wait_csr3)) + geom_point(shape=1) + geom_smooth(method=lm, na.rm=TRUE) + ggtitle("CSR3 complaints") + geom_text(label=districts[c(-12,-26),]$district_number, hjust=1.2)
p4
multiplot(p1, p2, p3, p4, cols=2)
ggplot(districts[!(districts$district_number %in% c(2121, 2103, 1133, 1132))], aes(x=complaints, y=median_wait)) + geom_point(shape=1) + geom_smooth(method=lm) + ggtitle("all complaints")
ggplot(districts[!(districts$district_number %in% c(2121, 2103, 1133, 1132)),], aes(x=complaints, y=median_wait)) + geom_point(shape=1) + geom_smooth(method=lm) + ggtitle("all complaints")
ggplot(districts[!(districts$district_number %in% c(2121, 2103, 1133, 1132)),], aes(x=complaints, y=median_wait)) + geom_point(shape=1) + geom_smooth(method=lm) + ggtitle("all complaints") + geom_text(label=districts$district_number, hjust=1.2)
ggplot(districts[!(districts$district_number %in% c(2121, 2103, 1133, 1132)),], aes(x=complaints, y=median_wait)) + geom_point(shape=1) + geom_smooth(method=lm) + ggtitle("all complaints") + geom_text(label=districts$district_number %in% c(2121, 2103, 1133, 1132)),], hjust=1.2)
ggplot(districts[!(districts$district_number %in% c(2121, 2103, 1133, 1132)),], aes(x=complaints, y=median_wait)) + geom_point(shape=1) + geom_smooth(method=lm) + ggtitle("all complaints") + geom_text(label=districts$district_number, hjust=1.2)
ggplot(districts[!(districts$district_number %in% c(2121, 2103, 1133, 1132)),], aes(x=complaints, y=median_wait)) + geom_point(shape=1) + geom_smooth(method=lm) + ggtitle("all complaints") + geom_text(label=districtss[!(districts$district_number %in% c(2121, 2103, 1133, 1132)),]$district_number, hjust=1.2)
ggplot(districts[!(districts$district_number %in% c(2121, 2103, 1133, 1132)),], aes(x=complaints, y=median_wait)) + geom_point(shape=1) + geom_smooth(method=lm) + ggtitle("all complaints") + geom_text(label=districts[!(districts$district_number %in% c(2121, 2103, 1133, 1132)),]$district_number, hjust=1.2)
m1 <- lm(districts[!(districts$district_number %in% c(2121, 2103, 1133, 1132)),]$complaints~districts[!(districts$district_number %in% c(2121, 2103, 1133, 1132)),]$median_wait)
summary(m1)
